{"review": [{"text_id": "Syev33W527", "sid": 0, "sentence": "Gradient-free evolutionary search methods for Reinforcement Learning are typically very stable, but scale poorly with the number of parameters when optimizing highly-parametrized policies (e.g. neural networks)."}, {"text_id": "Syev33W527", "sid": 1, "sentence": "Meanwhile, gradient-based deep RL methods, such as DDPG are often sample efficient, particularly in the off-policy setting when, unlike evolutionary search methods, they can continue to use previous experience to estimate values."}, {"text_id": "Syev33W527", "sid": 2, "sentence": "However, these approaches can also be unstable."}, {"text_id": "Syev33W527", "sid": 3, "sentence": "This work combines the well-known CEM search with TD3 (an improved variant of DDPG)."}, {"text_id": "Syev33W527", "sid": 4, "sentence": "The key idea of of this work is in each generation of CEM, 1/2 the individuals are improved using TD3 (i.e. the RL gradient)."}, {"text_id": "Syev33W527", "sid": 5, "sentence": "This method is made more practical by using a replay buffer so experience from previous generations is used for the TD3 updates and importance sampling is used to improve the efficiency of CEM."}, {"text_id": "Syev33W527", "sid": 6, "sentence": "This work shows, on some simple control tasks, that this method appears to result in much stronger performance compared with CEM, and small improvements over TD3 alone."}, {"text_id": "Syev33W527", "sid": 7, "sentence": "It also typically out-performs ERL."}, {"text_id": "Syev33W527", "sid": 8, "sentence": "Intuitively, it seems like it may be possible to construct counter-examples where the gradient updates will prevent convergence."}, {"text_id": "Syev33W527", "sid": 9, "sentence": "Issues of convergence seem like they deserve some discussion here and potentially could be examined empirically (is CEM-TD3 converging in the swimmer?)."}, {"text_id": "Syev33W527", "sid": 10, "sentence": "The justification that the method of Khadka & Tumer (2018) cannot be extended to use CEM, since the RL policies do not comply with the covariance matrix is unclear to me."}, {"text_id": "Syev33W527", "sid": 11, "sentence": "Algorithm 1, step 20, the covariance matrix is updated after the RL step so regardless of how the RL policies are generated, the search distribution on the next distribution includes them."}, {"text_id": "Syev33W527", "sid": 12, "sentence": "In both this work, and Khadka & Tumer, the RL updates lead to policies that differ from the search distribution (indeed that is the point), and there is no guarantee in this work that the TD3 updates result in policies close to the starting point."}, {"text_id": "Syev33W527", "sid": 13, "sentence": "It sees like the more important distinction is that, in this approach, the information flows both from ES to RL and vice-versa, rather than just from RL to ES."}, {"text_id": "Syev33W527", "sid": 14, "sentence": "One view of this method would be that it is an ensemble method for learning the policy [e.g. similar to Osband et al., 2016 for DQN]."}, {"text_id": "Syev33W527", "sid": 15, "sentence": "This could be discussed and a relevant control would be to keep a population (ensemble) of policies, but only update using RL while sharing experience across all actors."}, {"text_id": "Syev33W527", "sid": 16, "sentence": "This would isolate the ensemble effect from the evolutionary search."}, {"text_id": "Syev33W527", "sid": 17, "sentence": "Minor issues:"}, {"text_id": "Syev33W527", "sid": 18, "sentence": "- The ReLU non-linearity in DDPG and TD3 prior work is replaced with tanh."}, {"text_id": "Syev33W527", "sid": 19, "sentence": "This change is noted, but it would be useful to make a least a brief (i.e. one sentence) comment on the motivation for this change."}, {"text_id": "Syev33W527", "sid": 20, "sentence": "- The paper is over the hard page limit for ICLR so needs to be edit to reduce the length."}, {"text_id": "Syev33W527", "sid": 21, "sentence": "Osband I, Blundell C, Pritzel A, Van Roy B. Deep exploration via bootstrapped DQN. InAdvances in neural information processing systems 2016 (pp. 4026-4034)."}], "reviewlabels": [{"text_id": "Syev33W527", "sid": 0, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 1, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 2, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 3, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 4, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 5, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 6, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 7, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 8, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 9, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 10, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 11, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 12, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 13, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 14, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 15, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Soundness/Correctness", "pol": "U-Neutral"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 16, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 17, "labels": {"coarse": "Structuring", "fine": "Structuring.Heading", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 18, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 19, "labels": {"coarse": "Request", "fine": "Request.Edit", "asp": "Clarity", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 20, "labels": {"coarse": "Request", "fine": "Request.Edit", "asp": "Other", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "Syev33W527", "sid": 21, "labels": {"coarse": "Other", "fine": "Other", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}], "rebuttal": [{"text_id": "rkxM5djb0Q", "sid": 0, "sentence": "We thank the reviewer for his/her positive evaluation of our paper and for raising many very useful points which helped us getting to a clearer picture of our contribution."}, {"text_id": "rkxM5djb0Q", "sid": 1, "sentence": "A few of these points deserve discussion beyond the changes made in the paper."}, {"text_id": "rkxM5djb0Q", "sid": 2, "sentence": "Due to a mistake on page 2, we got the reviewer confused believing we are using importance sampling while we are using importance mixing instead."}, {"text_id": "rkxM5djb0Q", "sid": 3, "sentence": "This has been fixed."}, {"text_id": "rkxM5djb0Q", "sid": 4, "sentence": "The reviewer mentions it may be possible to construct counter-examples where the gradient updates will prevent convergence."}, {"text_id": "rkxM5djb0Q", "sid": 5, "sentence": "This is a very important point."}, {"text_id": "rkxM5djb0Q", "sid": 6, "sentence": "There are many RL problems (see e.g. Continuous Mountain Car, Colas et al. at ICML 2018) where at some point the gradient computed by the critic is deceptive, i.e. it drives the policy parameters into a wrong direction."}, {"text_id": "rkxM5djb0Q", "sid": 7, "sentence": "In that case, applying that gradient to CEM actors as we do in CEM-RL is counter-productive."}, {"text_id": "rkxM5djb0Q", "sid": 8, "sentence": "But the fact that we only apply this gradient to half the population makes it that CEM-RL should nevertheless overcome this issue:  the actors which did not receive a gradient step will be selected and the population will continue improving."}, {"text_id": "rkxM5djb0Q", "sid": 9, "sentence": "However, admittedly, in this very specific context, CEM-RL is behaving as a CEM with only half a population, thus it is less efficient than the standard CEM."}, {"text_id": "rkxM5djb0Q", "sid": 10, "sentence": "Besides, ERL even better resists than our approach to the same issue: if the actor generated by DDPG does not perform better than the evolutionary population due to a deceptive gradient issue, then this actor is just ignored, and the evolutionary part behaves as usual, without any loss in performance."}, {"text_id": "rkxM5djb0Q", "sid": 11, "sentence": "This deceptive gradient issue certainly explains why CEM is the best approach on Swimmer."}, {"text_id": "rkxM5djb0Q", "sid": 12, "sentence": "Finally, it may also happen that the RL part does not bring benefit just because the current critic is wrong and provides an inadequate gradient, in a non-deceptive gradient case."}, {"text_id": "rkxM5djb0Q", "sid": 13, "sentence": "All the above points have now been made much clear in the new version of the paper, in particular we added an appendix dedicated to the swimmer benchmark."}, {"text_id": "rkxM5djb0Q", "sid": 14, "sentence": "The reviewer also raises doubts about the fact that the method of Khadka & Tumer (2018) cannot be extended to use CEM."}, {"text_id": "rkxM5djb0Q", "sid": 15, "sentence": "After second thoughts, this is absolutely right."}, {"text_id": "rkxM5djb0Q", "sid": 16, "sentence": "As the reviewer says, in both this work and Khadka & Tumer, the RL updates lead to policies that may differ a lot from the search distribution and there is no guarantee in this work that the TD3 updates result in policies close to the starting point."}, {"text_id": "rkxM5djb0Q", "sid": 17, "sentence": "But if the RL actor shows good enough performance, this does not prevent from computing a new covariance matrix which includes it."}, {"text_id": "rkxM5djb0Q", "sid": 18, "sentence": "The corresponding ellipsoid in the search space may be very large, leading to a widespread next generation, but the process should tend to converge again towards a population of actors where evolutionary and RL actors are closer to each other."}, {"text_id": "rkxM5djb0Q", "sid": 19, "sentence": "A result of these second thoughts is that one could definitely build an ERL algorithm where the evolutionary part is replaced by CEM."}, {"text_id": "rkxM5djb0Q", "sid": 20, "sentence": "We corrected the paper according to this new insight."}, {"text_id": "rkxM5djb0Q", "sid": 21, "sentence": "Unfortunately we did not find enough time to implement and test this algorithm during the rebuttal stage, but we now mention this possibility as an interesting avenue for future work."}, {"text_id": "rkxM5djb0Q", "sid": 22, "sentence": "Despite the very interesting points above, the reviewer is wrong when saying that the main distinction between our approach and the ERL approach is that only in ours the information flow is from ES to RL and vice-versa."}, {"text_id": "rkxM5djb0Q", "sid": 23, "sentence": "Actually, in ERL, if the RL actor added to the population performs well, it will steer the whole evolutionary population to the right direction just by generating offsprings, so RL and ES also benefit from each other."}, {"text_id": "rkxM5djb0Q", "sid": 24, "sentence": "A lot of our effort during the rebuttal stage has been focused on better highlighting the often subtle differences between ERL and our approach."}, {"text_id": "rkxM5djb0Q", "sid": 25, "sentence": "For doing so, we replaced Figure 1 with a figure directly contrasting CEM-RL to ERL."}, {"text_id": "rkxM5djb0Q", "sid": 26, "sentence": "We also added Figure 6 which better highlights the properties of the algorithms and we performed several additional studies described either in the main text or in appendices."}, {"text_id": "rkxM5djb0Q", "sid": 27, "sentence": "The next point of the reviewer is that a good deal of the strong performance of our method and RL may just be due to the fact that we are using multiple actors, thus benefiting from an \"ensemble method\" effect already mentioned in several papers such as Osband et al., 2016 for DQN."}, {"text_id": "rkxM5djb0Q", "sid": 28, "sentence": "This point is absolutely valid."}, {"text_id": "rkxM5djb0Q", "sid": 29, "sentence": "The reviewer thus suggests a relevant control which would be to keep a population (ensemble) of policies, but only update using RL while sharing experience across all actors."}, {"text_id": "rkxM5djb0Q", "sid": 30, "sentence": "This would isolate the ensemble effect from the evolutionary search effect."}, {"text_id": "rkxM5djb0Q", "sid": 31, "sentence": "We performed the suggested control."}, {"text_id": "rkxM5djb0Q", "sid": 32, "sentence": "The resulting algorithm is a multiple-actor version of TD3."}, {"text_id": "rkxM5djb0Q", "sid": 33, "sentence": "Results show that CEM-TD3 actually outperforms this multiple-actor TD3, thus the CEM part actually brings performance improvement."}, {"text_id": "rkxM5djb0Q", "sid": 34, "sentence": "About replacing the ReLU non-linearity in DDPG and TD3 prior work with tanh, we spotted that we could get much better results on several environments with the latter."}, {"text_id": "rkxM5djb0Q", "sid": 35, "sentence": "This explanation is now clearly mentioned in the paper, and motivates a future work direction which consists in using \"neural architecture search\" for RL problems, the performance of algorithms being a lot dependent on such architecture details."}, {"text_id": "rkxM5djb0Q", "sid": 36, "sentence": "Finally, to keep our paper shorter than the hard page limit for ICLR while addressing all the reviewers points, we had to move several studies into appendices, starting with the importance mixing study."}], "rebuttallabels": [{"labels": {"alignments": [], "responsetype": "social", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 0}, {"labels": {"alignments": [], "responsetype": "social", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 1}, {"labels": {"alignments": [5], "responsetype": "contradict-assertion", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 2}, {"labels": {"alignments": [5], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 3}, {"labels": {"alignments": [8, 9], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 4}, {"labels": {"alignments": [8, 9], "responsetype": "contradict-assertion", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 5}, {"labels": {"alignments": [8, 9], "responsetype": "contradict-assertion", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 6}, {"labels": {"alignments": [8, 9], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 7}, {"labels": {"alignments": [8, 9], "responsetype": "contradict-assertion", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 8}, {"labels": {"alignments": [8, 9], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 9}, {"labels": {"alignments": [8, 9], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 10}, {"labels": {"alignments": [8, 9], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 11}, {"labels": {"alignments": [8, 9], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 12}, {"labels": {"alignments": [8, 9], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 13}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 14}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 15}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 16}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "mitigate-criticism", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 17}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "mitigate-criticism", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 18}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "future", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 19}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 20}, {"labels": {"alignments": [10, 11, 12, 13], "responsetype": "future", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 21}, {"labels": {"alignments": [13], "responsetype": "contradict-assertion", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 22}, {"labels": {"alignments": [13], "responsetype": "contradict-assertion", "coarseresponse": "dispute"}, "text_id": "rkxM5djb0Q", "sid": 23}, {"labels": {"alignments": [13], "responsetype": "summary", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 24}, {"labels": {"alignments": [13], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 25}, {"labels": {"alignments": [13], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 26}, {"labels": {"alignments": [14, 15, 16], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 27}, {"labels": {"alignments": [14, 15, 16], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 28}, {"labels": {"alignments": [14, 15, 16], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 29}, {"labels": {"alignments": [14, 15, 16], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "rkxM5djb0Q", "sid": 30}, {"labels": {"alignments": [14, 15, 16], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 31}, {"labels": {"alignments": [14, 15, 16], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 32}, {"labels": {"alignments": [14, 15, 16], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 33}, {"labels": {"alignments": [18, 19], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 34}, {"labels": {"alignments": [18, 19], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 35}, {"labels": {"alignments": [20], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "rkxM5djb0Q", "sid": 36}], "metadata": {"anno": "anno0", "review": "Syev33W527", "rebuttal": "rkxM5djb0Q", "conference": "ICLR2019", "title": "CEM-RL: Combining evolutionary and gradient-based methods for policy search", "reviewer": "AnonReviewer3", "forum_id": "BkeU5j0ctQ", "rating": "7: Good paper, accept", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}}