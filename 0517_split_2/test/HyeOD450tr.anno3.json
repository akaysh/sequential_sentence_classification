{"review": [{"text_id": "HyeOD450tr", "sid": 0, "sentence": "This paper introduces a structured drop-in replacement for linear layers in a neural network, referred to as Kaleidoscope matrices."}, {"text_id": "HyeOD450tr", "sid": 1, "sentence": "The class of such matrices are proven to be highly expressive and includes a very general class of sparse matrices, including convolution, Fastfood, and permutation matrices."}, {"text_id": "HyeOD450tr", "sid": 2, "sentence": "Experiments are carried in a variety of settings: (i) can nearly replace a series of hand-designed feature extractor, (ii) can perform better than fixed permutation matrices (though parameter count also increased by 10%), (iii) can learn permutations, and (iv) can help reduce parameter count and increase inference speed with a small performance degradation of 1.0 BLEU on machine translation."}, {"text_id": "HyeOD450tr", "sid": 3, "sentence": "This appears to be a solid contribution in terms of both theory and practical use."}, {"text_id": "HyeOD450tr", "sid": 4, "sentence": "As I have not thought much about expressiveness in terms of arithmetic circuits (though I was unable to fully follow or appreciate the derivations, the explanations all seem reasonable)"}, {"text_id": "HyeOD450tr", "sid": 5, "sentence": ", my main comments are regarding experiments."}, {"text_id": "HyeOD450tr", "sid": 6, "sentence": "Though there are experiments in different domains, each could benefit from some additional ablations, especially to existing parameterizations of structured matrices such as Fastfood, ACDC, and any of the multiple works on permutation matrices and/or orthogonal matrices."}, {"text_id": "HyeOD450tr", "sid": 7, "sentence": "Though Kaleidoscope include these as special cases, it is not clear whether when given the same resources (either memory or computational cost), Kaleidoscope would outperform them."}, {"text_id": "HyeOD450tr", "sid": 8, "sentence": "There is also a matter of ease of training compared to existing approximations or relaxations, e.g. Gumbel-Sinkhorn."}, {"text_id": "HyeOD450tr", "sid": 9, "sentence": "Pros:"}, {"text_id": "HyeOD450tr", "sid": 10, "sentence": "- The writing is easy to follow and concise, with contributions and place in the literature clearly stated."}, {"text_id": "HyeOD450tr", "sid": 11, "sentence": "- The Kaleidoscope matrix seem generally applicable, both proven theoretically and shown empirically (experiments are spread across a wide range of domains)."}, {"text_id": "HyeOD450tr", "sid": 12, "sentence": "- The code includes specific C++ and CUDA kernels for computing K matrices, which will be very useful for adaptation."}, {"text_id": "HyeOD450tr", "sid": 13, "sentence": "- The reasoning using arithmetic circuits seems interesting, and the Appendix includes a primer."}, {"text_id": "HyeOD450tr", "sid": 14, "sentence": "Cons:"}, {"text_id": "HyeOD450tr", "sid": 15, "sentence": "- For the squeezenet and latent permutation experiments, would be nice if there is a comparison to other parameterizations of permutation matrices, e.g. gumbel-sinkhorn."}, {"text_id": "HyeOD450tr", "sid": 16, "sentence": "- For the speed processing experiment, did you test what the performance would be if K matrix is replaced by a fully connected layer?"}, {"text_id": "HyeOD450tr", "sid": 17, "sentence": "This comparison appears in other experiments, but seems to be missing here for some reason."}, {"text_id": "HyeOD450tr", "sid": 18, "sentence": "It would lead to better understanding than only comparing to SincNet."}, {"text_id": "HyeOD450tr", "sid": 19, "sentence": "- The setup for the learning to permute experiment is not as general as it would imply in the main text."}, {"text_id": "HyeOD450tr", "sid": 20, "sentence": "The matrices are constrained so that an actual permutation matrix is always sampled, and the permutation is (had to be?) pretrained to reduce total variation for 100 epochs before jointly trained with the classifier."}, {"text_id": "HyeOD450tr", "sid": 21, "sentence": "Though this is stated very clearly in the Appendix, I hope the authors can also communicate this clearly in the main text as it appears to be a crucial component of the experimental setup."}, {"text_id": "HyeOD450tr", "sid": 22, "sentence": "Comments:"}, {"text_id": "HyeOD450tr", "sid": 23, "sentence": "- How easy is it to train with K matrices? Did you have to change optimizer hyperparameter compared to existing baselines?"}, {"text_id": "HyeOD450tr", "sid": 24, "sentence": "- There seems to be some blurring between the meaning of structure (used to motivate K matrices in the introduction) and sparsity (used to analyze K matrices)."}, {"text_id": "HyeOD450tr", "sid": 25, "sentence": "Structure might also include parameter sharing, orthogonality, and maybe other concepts."}, {"text_id": "HyeOD450tr", "sid": 26, "sentence": "For instance, while Kaleidoscope matrices might include the subclass of circulant matrices, can they also capture the same properties or \"inductive bias\" (for lack of better word) as convolutional layers when trained?"}], "reviewlabels": [{"text_id": "HyeOD450tr", "sid": 0, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 1, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Replicability", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 2, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 3, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 4, "labels": {"coarse": "Social", "fine": "Social", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": true}, {"text_id": "HyeOD450tr", "sid": 5, "labels": {"coarse": "Social", "fine": "Social", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": true}, {"text_id": "HyeOD450tr", "sid": 6, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Motivation/Impact", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 7, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Meaningful Comparison", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 8, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 9, "labels": {"coarse": "Structuring", "fine": "Structuring.Heading", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 10, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Clarity", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 11, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Replicability", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 12, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 13, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 14, "labels": {"coarse": "Structuring", "fine": "Structuring.Heading", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 15, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Meaningful Comparison", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 16, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": true}, {"text_id": "HyeOD450tr", "sid": 17, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": true}, {"text_id": "HyeOD450tr", "sid": 18, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 19, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": true}, {"text_id": "HyeOD450tr", "sid": 20, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": true}, {"text_id": "HyeOD450tr", "sid": 21, "labels": {"coarse": "Request", "fine": "Request.Clarification", "asp": "Substance", "pol": "U-Neutral"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 22, "labels": {"coarse": "Structuring", "fine": "Structuring.Heading", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 23, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 24, "labels": {"coarse": "Request", "fine": "Request.Explanation", "asp": "Substance", "pol": "U-Neutral"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 25, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "HyeOD450tr", "sid": 26, "labels": {"coarse": "Request", "fine": "Request.Clarification", "asp": "Substance", "pol": "U-Neutral"}, "secondarylabels": [], "merge-with-prior": false}], "rebuttal": [{"text_id": "r1eYbUQ_oB", "sid": 0, "sentence": "We thank the reviewer for their encouraging feedback and thoughtful comments on our work."}, {"text_id": "r1eYbUQ_oB", "sid": 1, "sentence": "Regarding the permutation learning experiment, in response to the feedback, we have revised the main text to clarify the setup."}, {"text_id": "r1eYbUQ_oB", "sid": 2, "sentence": "The core of the experiment is the ability to denoise permuted images using some representation of the permutation set."}, {"text_id": "r1eYbUQ_oB", "sid": 3, "sentence": "In order to do this successfully, it is necessary for such a representation to have certain properties such as inducing a distribution over permutations."}, {"text_id": "r1eYbUQ_oB", "sid": 4, "sentence": "We have implemented and added a comparison to the Gumbel-Sinkhorn method (Mena et al., 2018), which is a customized representation for permutations with these properties, and requires similar techniques (unsupervised objective, permutation sampling, etc.) in order to learn the latent structure."}, {"text_id": "r1eYbUQ_oB", "sid": 5, "sentence": "The ResNet classifier on top can be viewed primarily as a way to evaluate the quality of the learned permutation; both of these representations are capable of learning the right latent structure, with test accuracies of 93.6 (Kaleidoscope) and 92.9 (Gumbel-Sinkhorn) respectively."}, {"text_id": "r1eYbUQ_oB", "sid": 6, "sentence": "The highlight of this experiment is that the K-matrix representation also comes with the requisite properties for this learning pipeline, despite not being explicitly designed for permutation learning."}, {"text_id": "r1eYbUQ_oB", "sid": 7, "sentence": "Regarding comparison to a dense matrix for the speech experiment, in Table 5 (Appendix B.1.2), we compare the use of K-matrices in the raw-features speech model with several other classes of matrices, including dense matrices."}, {"text_id": "r1eYbUQ_oB", "sid": 8, "sentence": "For instance, we find that, while using a trainable dense matrix slightly outperforms just using the fixed FFT (0.3% drop in test phoneme error rate), using a K-matrix instead of a dense matrix yields a further improvement of 0.8% in the phoneme error rate."}, {"text_id": "r1eYbUQ_oB", "sid": 9, "sentence": "Regarding ease of training and hyperparameter tuning, we would like to re-emphasize that for all experiments, all hyperparameters for training were kept the same as those for training the default model architecture, other than those we explicitly mentioned as being tuned."}, {"text_id": "r1eYbUQ_oB", "sid": 10, "sentence": "In particular, we did not modify any hyperparameters (such as number of epochs, optimizer, or learning rate) for the ShuffleNet and DynamicConv experiments."}, {"text_id": "r1eYbUQ_oB", "sid": 11, "sentence": "For the TIMIT speech experiment, we tune only the \u201cpreprocessing layer\u201d learning rate."}, {"text_id": "r1eYbUQ_oB", "sid": 12, "sentence": "This is because the default speech pipeline already uses different learning rates for different portions of the network, so there is no clear choice a priori for the learning rate of the \u201cpreprocessing layer\u201d (note that most methods, including K-matrices, do not seem to be overly sensitive to the choice of this learning rate)."}, {"text_id": "r1eYbUQ_oB", "sid": 13, "sentence": "Thus, in these experiments, K-matrices can be used as a drop-in replacement for linear layers without significant tuning effort."}, {"text_id": "r1eYbUQ_oB", "sid": 14, "sentence": "Regarding structure and sparsity: We use \u201cstructure\u201d in the context of structured matrices to mean matrices with a fast (subquadratic) multiplication algorithm."}, {"text_id": "r1eYbUQ_oB", "sid": 15, "sentence": "Structured matrices have a sparse factorization with total NNZ on the order of the number of operations required in the multiplication."}, {"text_id": "r1eYbUQ_oB", "sid": 16, "sentence": "This connection was known in the algebraic complexity community, and formalized by De Sa et al. (2018)."}, {"text_id": "r1eYbUQ_oB", "sid": 17, "sentence": "Regarding the inductive bias encoded by K-matrices: the building block of K-matrices is a butterfly matrix, which encodes the recursive divide-and-conquer structure of many fast algorithms such as the FFT."}, {"text_id": "r1eYbUQ_oB", "sid": 18, "sentence": "Analyzing the precise effects of the inductive bias imposed by K-matrices is an exciting question for future work."}], "rebuttallabels": [{"labels": {"alignments": [], "responsetype": "social", "coarseresponse": "nonarg"}, "text_id": "r1eYbUQ_oB", "sid": 0}, {"labels": {"alignments": [15], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 1}, {"labels": {"alignments": [15], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 2}, {"labels": {"alignments": [15], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 3}, {"labels": {"alignments": [15], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 4}, {"labels": {"alignments": [15], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 5}, {"labels": {"alignments": [15], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 6}, {"labels": {"alignments": [15], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 7}, {"labels": {"alignments": [15], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 8}, {"labels": {"alignments": [23], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 9}, {"labels": {"alignments": [23], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 10}, {"labels": {"alignments": [23], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 11}, {"labels": {"alignments": [16, 17, 23], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 12}, {"labels": {"alignments": [16, 17, 23], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 13}, {"labels": {"alignments": [24, 25, 26], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 14}, {"labels": {"alignments": [24, 25, 26], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 15}, {"labels": {"alignments": [24, 25, 26], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 16}, {"labels": {"alignments": [26], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 17}, {"labels": {"alignments": [26], "responsetype": "future", "coarseresponse": "concur"}, "text_id": "r1eYbUQ_oB", "sid": 18}], "metadata": {"anno": "anno3", "review": "HyeOD450tr", "rebuttal": "r1eYbUQ_oB", "conference": "ICLR2020", "title": "Kaleidoscope: An Efficient, Learnable Representation For All Structured Linear Maps", "reviewer": "AnonReviewer2", "forum_id": "BkgrBgSYDS", "rating": "8: Accept", "experience_assessment": "I have read many papers in this area."}}