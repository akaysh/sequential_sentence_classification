{"review": [{"text_id": "r1xXo7UF3m", "sid": 0, "sentence": "The paper addresses the problem of producing sensible (high) uncertainties on out of distribution (OOD) data along with accurate predictions on in-distribution data."}, {"text_id": "r1xXo7UF3m", "sid": 1, "sentence": "The authors consider a model wherein the weights of the network (\\theta) are drawn from a matrix normal distribution whose parameters are in-turn a (non-linear; parameterized by a another network) function of the covariates (x)."}, {"text_id": "r1xXo7UF3m", "sid": 2, "sentence": "Instead of inferring a posterior over theta that then induces the predictive uncertainties, uncertainties here arise from a regularizer that penalizes the distribution over theta from deviating too far from a standard Normal."}, {"text_id": "r1xXo7UF3m", "sid": 3, "sentence": "Experiments present results on toy data, MNIST/not MNIST as well as on adversarial perturbations of MNIST and CIFAR 10 datasets."}, {"text_id": "r1xXo7UF3m", "sid": 4, "sentence": "The paper is clearly written and addresses an important problem."}, {"text_id": "r1xXo7UF3m", "sid": 5, "sentence": "The paper presents both an alternate model as well as an alternate objective function."}, {"text_id": "r1xXo7UF3m", "sid": 6, "sentence": "While the authors do report some interesting results, they do a poor job of motivating the proposed extensions."}, {"text_id": "r1xXo7UF3m", "sid": 7, "sentence": "It isn\u2019t clear why the particular proposals are necessary or to which of the proposed extensions the inflated OOD uncertainties can be attributed:"}, {"text_id": "r1xXo7UF3m", "sid": 8, "sentence": "1. The proposed model? Is using a conditional weight prior p(\\theta | x) (Eq 3) instead of p(\\theta) (as in BNNs)  necessary for the inflated uncertainties on OOD data?"}, {"text_id": "r1xXo7UF3m", "sid": 9, "sentence": "2. The  objective? The proposed objective,  Eq 5, trades off stochastically approximating the (conditional) marginal likelihood against not deviating too much from p(\\theta) =  MN(0, I, I) in the KL sense."}, {"text_id": "r1xXo7UF3m", "sid": 10, "sentence": "Depending on \\lambda, the objective either closely approximates the marginal likelihood or not."}, {"text_id": "r1xXo7UF3m", "sid": 11, "sentence": "It is unclear how important this particular objective is to the results."}, {"text_id": "r1xXo7UF3m", "sid": 12, "sentence": "-  Instead of relying on the KL regularizer, a standard approach to learning the model in Eq 3 would be to use well understood MCMC or variational methods that explicitly retain uncertainty in \\theta and induce predictive uncertainties.  Were they explored and found to be not effective?"}, {"text_id": "r1xXo7UF3m", "sid": 13, "sentence": "It would be nice to see how a \u201cgold standard\u201d HMC based inference does on at least the small toy problem of Sec 5.1?"}, {"text_id": "r1xXo7UF3m", "sid": 14, "sentence": "- There is also a closely related variant of Eq 3 which we can arrive at by switching the log and the expectation in the first term of Eq 5 and applying Jensen\u2019s inequality \u2014> E_p(\\theta| x)[ln p(y | x, \\theta)] - KL (p(\\theta | x) || p(\\theta))."}, {"text_id": "r1xXo7UF3m", "sid": 15, "sentence": "This would correspond to maximizing a valid lower bound to the marginal likelihood of a BNN model p(y | x, \\theta) p(\\theta), while interpreting p(\\theta | x) as an amortized variational approximation."}, {"text_id": "r1xXo7UF3m", "sid": 16, "sentence": "This variant has the advantage that it provides a valid lower bound on the marginal likelihood, and exploits the well understood variational inference machinery."}, {"text_id": "r1xXo7UF3m", "sid": 17, "sentence": "This also immediately suggests, that the variational approximation , p (\\theta | x)  should probably depend on both x and y rather than only on x and the flexibility of the hyper networks g would govern how well the true posterior over weights \\theta can be approximated."}, {"text_id": "r1xXo7UF3m", "sid": 18, "sentence": "Comparisons against these more standard inference algorithms is essential for understanding what advantages are afforded by the objective proposed in the paper."}, {"text_id": "r1xXo7UF3m", "sid": 19, "sentence": "3.  Or simply to a well tuned \\lambda, chosen on a per dataset basis? From the text it appears that \\lambda is manually selected to trade off accuracy against uncertainty on OOD data."}, {"text_id": "r1xXo7UF3m", "sid": 20, "sentence": "In the real world, one would not have access to OOD data during training, how is one to pick \\lambda in such cases?"}, {"text_id": "r1xXo7UF3m", "sid": 21, "sentence": "Detailed comments about experiments:"}, {"text_id": "r1xXo7UF3m", "sid": 22, "sentence": "a) The uncertainties produced by CDN in Figure 2 seems strange."}, {"text_id": "r1xXo7UF3m", "sid": 23, "sentence": "Why does it go to nearly zero around x = 0, while being higher in surrounding regions with more data?"}, {"text_id": "r1xXo7UF3m", "sid": 24, "sentence": "b) Down weighting the KL term by lambda for the VI techniques unfairly biases the comparison."}, {"text_id": "r1xXo7UF3m", "sid": 25, "sentence": "This forces the VI solution to tend to the MLE, sacrificing uncertainty in the variational distribution."}, {"text_id": "r1xXo7UF3m", "sid": 26, "sentence": "It would be good to include comparisons against VI with \\lambda = 1."}, {"text_id": "r1xXo7UF3m", "sid": 27, "sentence": "=========="}, {"text_id": "r1xXo7UF3m", "sid": 28, "sentence": "There are potentially interesting ideas in this paper."}, {"text_id": "r1xXo7UF3m", "sid": 29, "sentence": "However, as presented these ideas are poorly justified and careful comparisons against sensible baselines are missing."}], "reviewlabels": [{"text_id": "r1xXo7UF3m", "sid": 0, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 1, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 2, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 3, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 4, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Clarity", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 5, "labels": {"coarse": "Structuring", "fine": "Structuring.Summary", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 6, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Replicability", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 7, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 8, "labels": {"coarse": "Request", "fine": "Request.Explanation", "asp": "Soundness/Correctness", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 9, "labels": {"coarse": "Request", "fine": "Request.Explanation", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 10, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 11, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 12, "labels": {"coarse": "Request", "fine": "Request.Explanation", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 13, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 14, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 15, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 16, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 17, "labels": {"coarse": "Fact", "fine": "Fact", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 18, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 19, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 20, "labels": {"coarse": "Request", "fine": "Request.Explanation", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 21, "labels": {"coarse": "Structuring", "fine": "Structuring.Heading", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 22, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 23, "labels": {"coarse": "Request", "fine": "Request.Explanation", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 24, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 25, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Soundness/Correctness", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 26, "labels": {"coarse": "Request", "fine": "Request.Experiment", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 27, "labels": {"coarse": "Structuring", "fine": "Structuring.Heading", "asp": "", "pol": ""}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 28, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Originality", "pol": "P-Positive"}, "secondarylabels": [], "merge-with-prior": false}, {"text_id": "r1xXo7UF3m", "sid": 29, "labels": {"coarse": "Evaluative", "fine": "Evaluative", "asp": "Substance", "pol": "N-Negative"}, "secondarylabels": [], "merge-with-prior": false}], "rebuttal": [{"text_id": "ryg0dWFrC7", "sid": 0, "sentence": "We thank the reviewer for the valuable feedback!"}, {"text_id": "ryg0dWFrC7", "sid": 1, "sentence": "The suggestion comments were very helpful and led to a clear improvement of our manuscript."}, {"text_id": "ryg0dWFrC7", "sid": 2, "sentence": "We reply to the answers and comments in the order they were raised:"}, {"text_id": "ryg0dWFrC7", "sid": 3, "sentence": "(1) If one uses the same matrix-variate normal distribution that we use for p(\\theta | x) as approximate posterior p(\\theta) of a BNN in conjunction with the ELBO objective, one arrives at a BNN proposed by Louizos and Welling (2016) [1], i.e. the Variational Matrix Gaussian (VMG)."}, {"text_id": "ryg0dWFrC7", "sid": 4, "sentence": "We found that VMG\u2019s results (obtained from their original code https://github.com/AMLab-Amsterdam/SEVDL_MGP) are not as good as that for the CDN, as shown in Figure 8 in the appendix."}, {"text_id": "ryg0dWFrC7", "sid": 5, "sentence": "This is further discussed in the newly added section 6.4."}, {"text_id": "ryg0dWFrC7", "sid": 6, "sentence": "(2) Thank you for this valuable suggestion!"}, {"text_id": "ryg0dWFrC7", "sid": 7, "sentence": "We have added a new section (Sec. 4) to discuss the differences between the objective used for CDN, when performing variational inference for BNNs, and in the variational information bottleneck (VIB) framework."}, {"text_id": "ryg0dWFrC7", "sid": 8, "sentence": "Furthermore, we present an experimental investigation of these different objectives (Sec. 6.4)."}, {"text_id": "ryg0dWFrC7", "sid": 9, "sentence": "We found that the CDN objective leads to superior results, especially in the adversarial examples experiment."}, {"text_id": "ryg0dWFrC7", "sid": 10, "sentence": "(3) We observed that as \\lambda increases, in the validation set, the uncertainty is increasing, while the accuracy is decreasing."}, {"text_id": "ryg0dWFrC7", "sid": 11, "sentence": "So"}, {"text_id": "ryg0dWFrC7", "sid": 12, "sentence": ", a simple heuristic that we use is to choose the highest \\lambda that allow high validation accuracy (e.g. > 0.97 on MNIST)."}, {"text_id": "ryg0dWFrC7", "sid": 13, "sentence": "We found that this heuristic works very well in our experiments (the results have updated to reflect on this heuristic)."}, {"text_id": "ryg0dWFrC7", "sid": 14, "sentence": "We have made this procedure clear in the revised manuscript."}, {"text_id": "ryg0dWFrC7", "sid": 15, "sentence": "Detailed comments about experiments:"}, {"text_id": "ryg0dWFrC7", "sid": 16, "sentence": "(a) Thanks for catching this. Indeed this was due to a bug in the toy regression experiment which we have fixed now."}, {"text_id": "ryg0dWFrC7", "sid": 17, "sentence": "(b) We have revised the baselines so that they either use \\lambda = 1 or the settings that the original authors recommended."}, {"text_id": "ryg0dWFrC7", "sid": 18, "sentence": "We detail this in Appendix F."}, {"text_id": "ryg0dWFrC7", "sid": 19, "sentence": "References:"}, {"text_id": "ryg0dWFrC7", "sid": 20, "sentence": "[1] Louizos, Christos, and Max Welling. \"Structured and efficient variational deep learning with matrix gaussian posteriors.\" International Conference on Machine Learning. 2016."}], "rebuttallabels": [{"labels": {"alignments": [], "responsetype": "social", "coarseresponse": "nonarg"}, "text_id": "ryg0dWFrC7", "sid": 0}, {"labels": {"alignments": [], "responsetype": "social", "coarseresponse": "nonarg"}, "text_id": "ryg0dWFrC7", "sid": 1}, {"labels": {"alignments": [], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "ryg0dWFrC7", "sid": 2}, {"labels": {"alignments": [7, 8], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 3}, {"labels": {"alignments": [7, 8], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 4}, {"labels": {"alignments": [7, 8], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 5}, {"labels": {"alignments": [12, 13, 14, 15, 16, 17, 18], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 6}, {"labels": {"alignments": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 7}, {"labels": {"alignments": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 8}, {"labels": {"alignments": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 9}, {"labels": {"alignments": [19, 20], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 10}, {"labels": {"alignments": [19, 20], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 11}, {"labels": {"alignments": [19, 20], "responsetype": "answer", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 12}, {"labels": {"alignments": [19, 20], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 13}, {"labels": {"alignments": [19, 20], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 14}, {"labels": {"alignments": [], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "ryg0dWFrC7", "sid": 15}, {"labels": {"alignments": [22, 23], "responsetype": "concede-criticism", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 16}, {"labels": {"alignments": [24, 25, 26], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 17}, {"labels": {"alignments": [24, 25, 26], "responsetype": "done_manu_Yes", "coarseresponse": "concur"}, "text_id": "ryg0dWFrC7", "sid": 18}, {"labels": {"alignments": [], "responsetype": "structuring", "coarseresponse": "nonarg"}, "text_id": "ryg0dWFrC7", "sid": 19}, {"labels": {"alignments": [], "responsetype": "other", "coarseresponse": "nonarg"}, "text_id": "ryg0dWFrC7", "sid": 20}], "metadata": {"anno": "anno10", "review": "r1xXo7UF3m", "rebuttal": "ryg0dWFrC7", "conference": "ICLR2019", "title": "Compound Density Networks", "reviewer": "AnonReviewer2", "forum_id": "rkgv9oRqtQ", "rating": "5: Marginally below acceptance threshold", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}}